#define COMP
#include <def.glsl>
layout(local_size_x = 256) in;
void main(){
	uint i = gl_GlobalInvocationID.x;
	if (i >= cmn.cnt)
		return;
	Circle obj = cir[i];

	uvec2 p = uvec2(obj.pv.xy * 1e3) & 255;
	uint id = p.y << 8 | p.x;

	uint cnt = atomicAdd(grid[id].cnt, 1);
	grid[id].cir[cnt & 7] = obj;
}
